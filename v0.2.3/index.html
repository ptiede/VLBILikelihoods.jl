<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · VLBILikelihoods.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://ptiede.github.io/VLBILikelihoods.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>VLBILikelihoods.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ptiede/VLBILikelihoods.jl/blob/main/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="VLBILikelihoods"><a class="docs-heading-anchor" href="#VLBILikelihoods">VLBILikelihoods</a><a id="VLBILikelihoods-1"></a><a class="docs-heading-anchor-permalink" href="#VLBILikelihoods" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/ptiede/VLBILikelihoods.jl">VLBILikelihoods</a>.</p><ul><li><a href="#VLBILikelihoods.AbstractVLBIDistributions"><code>VLBILikelihoods.AbstractVLBIDistributions</code></a></li><li><a href="#VLBILikelihoods.AmplitudeLikelihood-Tuple{AbstractVector, AbstractVector}"><code>VLBILikelihoods.AmplitudeLikelihood</code></a></li><li><a href="#VLBILikelihoods.ClosurePhaseLikelihood"><code>VLBILikelihoods.ClosurePhaseLikelihood</code></a></li><li><a href="#VLBILikelihoods.CoherencyLikelihood"><code>VLBILikelihoods.CoherencyLikelihood</code></a></li><li><a href="#VLBILikelihoods.ComplexVisLikelihood"><code>VLBILikelihoods.ComplexVisLikelihood</code></a></li><li><a href="#VLBILikelihoods.RiceAmplitudeLikelihood-Tuple{AbstractVector, AbstractVector}"><code>VLBILikelihoods.RiceAmplitudeLikelihood</code></a></li><li><a href="#VLBILikelihoods.lognorm-Tuple{VLBILikelihoods.AbstractVLBIDistributions}"><code>VLBILikelihoods.lognorm</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="VLBILikelihoods.AbstractVLBIDistributions" href="#VLBILikelihoods.AbstractVLBIDistributions"><code>VLBILikelihoods.AbstractVLBIDistributions</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractVLBIDistributions &lt;: Distributions.Distribution{Distributions.Multivariate, Distributions.Continuous}</code></pre><p>Abstract type that detail that the distribution is the likelihood for some VLBI dataproduct. One key difference between an <code>AbstractVLBIDistribution</code> and a regular <code>Distributions.jl</code> one is that by default we expect on the fields of the <code>struct</code> defining the distribution to be <code>lognorm</code> which gives the log-normalization constant for the distribution.</p><p>This prevents the model from constantly having to compute the log-normalization constant everytime the density is evaluated, which is often the most expensive part of the computation.</p><p>To implement a <code>AbstractVLBIDistributions</code> a user then just needs to implement</p><ul><li><code>unormed_logdensity(d::AbstractVLBIDistribution, x)</code></li></ul><p>which takes in the new distribution type <code>d</code> and the point you wish to evaluate the density at. Internally <code>VLBILikelihood</code> add in the normalization constant.</p><p>Additionally, if the user wishes to change this behavior they can also overload the <code>lognorm</code> function to opt-out of storing the normalization constant in the <code>struct</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ptiede/VLBILikelihoods.jl/blob/438fad41dff9d616c2b0bf7155fdf2206be0e242/src/VLBILikelihoods.jl#L25-L43">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VLBILikelihoods.AmplitudeLikelihood-Tuple{AbstractVector, AbstractVector}" href="#VLBILikelihoods.AmplitudeLikelihood-Tuple{AbstractVector, AbstractVector}"><code>VLBILikelihoods.AmplitudeLikelihood</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">AmplitudeLikelihood(μ, Σ::Union{AbstractVector, AbstractMatrix})</code></pre><p>Forms the likelihood for amplitudes from the mean vector <code>μ</code> and the covariance matrix <code>Σ</code>. If Σ is vector or a diagonal matrix then we assume that the argument is the diagonal covariance matrix. If Σ is a full matrix then we assume that a dense covariance was passed</p><p><strong>Notes</strong></p><p>We do no processing to the data, i.e. the mean μ is not-debiased anywhere.</p><p><strong>Warning</strong></p><p>This likelihood will be significantly biased from the true Rice distribution for data points with SNR = μ/Σ &lt; 2. If this matter significantly for you, we recommend that you consider fitting pure complex visibilities instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ptiede/VLBILikelihoods.jl/blob/438fad41dff9d616c2b0bf7155fdf2206be0e242/src/amplitude.jl#L13-L30">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VLBILikelihoods.ClosurePhaseLikelihood" href="#VLBILikelihoods.ClosurePhaseLikelihood"><code>VLBILikelihoods.ClosurePhaseLikelihood</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ClosurePhaseLikelihood(μ, Σ)</code></pre><p>Construct the Gaussian approximate closure phase likelihood distribution. The distribution used here is not the exact distribution for closure phases since this becomes quite complicated (especially for correlated covariances). For our approximation we take the Gaussian around the complex exponential of the phase, that is the unormalized likelihood is given by</p><p class="math-container">\[    \log\mathcal{L} = -\frac{1}{2}(e^{i\theta} - e^{i\mu})^T\Sigma^{-1}(e^{i\theta} - e^{i\mu})\]</p><p>If Σ is diagonal then this reduces to a bunch of independent Von Mises distributions, and if Σ is dense, this becomes a complicated multi-variate extension of the Von Mises distribution<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>.</p><p><strong>Parameters</strong></p><ul><li><code>μ</code>: The mean closure phase, which is usually computed from some VLBI model</li><li><code>Σ</code>: The measurement covariance matrix, which is usually computed directly from the data.      Note that <code>Σ</code> can either be a matrix or a vector. If <code>Σ</code> is a vector then we interpret      <code>Σ</code> to represent the diagonal of the covariance matrix.</li></ul><p><strong>Warning</strong></p><p>Note that for the dense Σ, the likelihood is not normalized properly since the normalization is not analytically tractable. This is not a problem for sampling since the normalizing constant does not depend on <code>μ</code> so it does not <em>usually</em> impact parameter estimation. However, if you are including terms that modify the covariance <code>Σ</code> then this likelihood is wrong and could give biased results. If you want to fit noise terms in Σ please either use the diagonal approximation to the likelihood, or <strong>better yet</strong> fit complex visibilities directly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ptiede/VLBILikelihoods.jl/blob/438fad41dff9d616c2b0bf7155fdf2206be0e242/src/closure_phase.jl#L3-L37">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VLBILikelihoods.CoherencyLikelihood" href="#VLBILikelihoods.CoherencyLikelihood"><code>VLBILikelihoods.CoherencyLikelihood</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ComplexVisLikelihood(μ::AbstractVector{&lt;:StaticMatrix{2,2}}, Σ::AbstractVector{&lt;:StaticMatrix{2,2, &lt;:Real}})</code></pre><p>Creates the coherency matrix likelihood distribution which is a Gaussian over the space of 2×2 complex visibilities.</p><p><strong>Paramters</strong></p><ul><li><code>μ</code>: The mean coherency matrix stored as a vector of 2x2 static matrices, which is usually computed from some VLBI model</li><li><code>Σ</code>: The measurement covariance matrix, which is usually computed directly from the data.      Note that <code>Σ</code> must vector of 2x2 real static matrices.</li></ul><p><strong>Notes</strong></p><p>You will get the best performance is all the vectors are given as StructVectors{&lt;:StaticMatrices{2,2}}, especially when computing gradients with an AD engine like Zygote.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ptiede/VLBILikelihoods.jl/blob/438fad41dff9d616c2b0bf7155fdf2206be0e242/src/coherency.jl#L4-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VLBILikelihoods.ComplexVisLikelihood" href="#VLBILikelihoods.ComplexVisLikelihood"><code>VLBILikelihoods.ComplexVisLikelihood</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ComplexVisLikelihood(μ::AbstractVector{&lt;:Complex}, Σ::AbstractVector{&lt;:Real})</code></pre><p>Creates the complex visibility likelihood distribution which is a diagonal complex Gaussian with strictly real covariance matrix.</p><p><strong>Paramters</strong></p><ul><li><code>μ</code>: The mean complex visibility, which is usually computed from some VLBI model</li><li><code>Σ</code>: The measurement covariance matrix, which is usually computed directly from the data.      Note that <code>Σ</code> must be a real element vector and is interpreted at the diagonal of the      covariance matrix.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ptiede/VLBILikelihoods.jl/blob/438fad41dff9d616c2b0bf7155fdf2206be0e242/src/complexvis.jl#L3-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VLBILikelihoods.RiceAmplitudeLikelihood-Tuple{AbstractVector, AbstractVector}" href="#VLBILikelihoods.RiceAmplitudeLikelihood-Tuple{AbstractVector, AbstractVector}"><code>VLBILikelihoods.RiceAmplitudeLikelihood</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">RiceAmplitudeLikelihood(μ, Σ::Union{AbstractVector, Diagonal})</code></pre><p>Forms the likelihood for amplitudes from the mean vector <code>μ</code> and the diagonal covariance matrix <code>Σ</code>. <code>Σ</code> can either be a Diagonal matrix or a vector whose entries are the variance for each data point.</p><p><strong>Notes</strong></p><p>This is the correct likelihood distribution for visibility amplitudes, but it is slower than the Gaussian approximation <code>AmplitudeLikelihood</code>. Additionally, i</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ptiede/VLBILikelihoods.jl/blob/438fad41dff9d616c2b0bf7155fdf2206be0e242/src/amplitude.jl#L92-L102">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="VLBILikelihoods.lognorm-Tuple{VLBILikelihoods.AbstractVLBIDistributions}" href="#VLBILikelihoods.lognorm-Tuple{VLBILikelihoods.AbstractVLBIDistributions}"><code>VLBILikelihoods.lognorm</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">lognorm(d::AbstractVLBIDistributions)</code></pre><p>Compute the log-normalizatoin constant of the distribution <code>d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ptiede/VLBILikelihoods.jl/blob/438fad41dff9d616c2b0bf7155fdf2206be0e242/src/VLBILikelihoods.jl#L46-L50">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>This distribution is defined on the n torus where n is the number of closure phases.</li></ul></section></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 15 February 2024 20:45">Thursday 15 February 2024</span>. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
